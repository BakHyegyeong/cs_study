# μ•„μ΄ν… 26 : λ΅ νƒ€μ…μ€ μ‚¬μ©ν•μ§€ λ§λΌ

# μ λ„¤λ¦­ νƒ€μ…

νƒ€μ… λ§¤κ°λ³€μ(`<T>`)κ°€ μ‚¬μ©λ ν΄λμ¤μ™€ μΈν„°νμ΄μ¤λ¥Ό ν†µν‹€μ–΄ λ¶€λ¥΄λ” κ²ƒ

μ λ„¤λ¦­ νƒ€μ…μ„ ν•λ‚ μ •μν•λ©΄, κ·Έμ— λ”Έλ¦° λ΅ νƒ€μ…λ„ ν•¨κ» μ •μλλ‹¤.

# λ΅ νƒ€μ…

μ λ„¤λ¦­ νƒ€μ…μ—μ„ νƒ€μ… λ§¤κ°λ³€μλ¥Ό μ „ν€ μ‚¬μ©ν•μ§€ μ•μ„ λ•λ¥Ό μλ―Έν•λ©° μ λ„¤λ¦­ νƒ€μ… μ •λ³΄κ°€ μ „λ¶€ μ§€μ›μ§„ κ²ƒμ²λΌ λ™μ‘ν•λ‹¤.

ex) `List<E>`μ λ΅ νƒ€μ…μ€Β `List`μ΄λ‹¤.

μ¦‰ νƒ€μ… λ§¤κ°λ³€μκ°€ μ‚¬μ©λμ§€ μ•μ€ ν΄λμ¤λ‚ μΈν„°νμ΄μ¤λ¥Ό μλ―Έν•λ‹¤.

## λ΅ νƒ€μ…μ λ‹¨μ 

```java
// Collection λ’¤μ— <>κ°€ μ‚¬μ©λμ§€ μ•μ•λ‹¤.
private final Collection stamps = RawType.getStamps();
stamps.add(new Coin(...));

for(Iterator i = stamps.iterator(); i.hasNext(); ){
	Stamp stamp = (Stamp) i.next();  //ClassCastException
    stamp.cancle();
 }
```

Stampνƒ€μ…λ§ μ €μ¥ν•λ” μ½”λ“μ΄μ§€λ§ Coinνƒ€μ…μ κ°μ²΄λ¥Ό λ„£μ–΄λ„ **μ»΄νμΌ μ¤λ¥λ” λ°μƒν•μ§€ μ•λ”λ‹¤.**

μ‹¤ν–‰μ„ ν• ν›„μ— **λ°νƒ€μ„ μ—λ¬`(ClassCastException)`κ°€ λ°μƒ**ν•κ² λλ‹¤.

## λ΅ νƒ€μ…λ³΄λ‹¤ μ λ„¤λ¦­μ„ μ‚¬μ©ν•΄μ•Ό ν•λ” μ΄μ 

```java
// Collection<Stamp>
private final Collection<Stamp> stamps = RawType.getStampsWithGenerics();
// λ§¤κ°λ³€μν™”λ μ»¬λ ‰μ… νƒ€μ…μΌλ΅ μ„ μ–Έν• κ²½μ° μλ»λ κ°μ²΄λ¥Ό λ„£μΌλ©΄ μ»΄νμΌ μ¤λ¥κ°€ λ°μƒν•λ‹¤.
stamps.add(new Coin(...));

for(Iterator i = stamps.iterator(); i.hasNext(); ){
	Stamp stamp = (Stamp) i.next();  //ClassCastException
    stamp.cancle();
 }
```

μ„μ™€ κ°™μ΄ μ„ μ–Έν•  κ²½μ° **νƒ€μ… μ•μ „μ„±μ„ ν™•λ³΄**ν•  μ μκ³  λ΅ νƒ€μ…μ„ μ‚¬μ©ν•  κ²½μ° μ λ„¤λ¦­μ΄ μ•κ²¨μ£Όλ” **μ•μ •μ„±κ³Ό ν‘ν„λ ¥μ„ λ¨λ‘ μƒκ² λλ‹¤.**

λ΅ νƒ€μ…μ€ μλ°” 1.4 μ΄ν• λ²„μ „μ— μ‘μ„±λ μ½”λ“μ™€μ νΈν™μ„±μ„ μ§€ν‚¤κΈ° μ„ν•΄ μ‚¬μ©λλ‹¤.

## `List`μ™€ `List<Object>`

`List`λ” λ΅ νƒ€μ…μΌλ΅ μ‚¬μ©ν•΄μ„λ” μ•λλ‚, `List<Object>`μ²λΌ μ„μμ κ°μ²΄λ¥Ό ν—μ©ν•λ” λ§¤κ°λ³€μν™” νƒ€μ…μ€ μ‚¬μ©ν•  μ μλ‹¤.

### μ λ„¤λ¦­μ ν•μ„ νƒ€μ… κ·μΉ™

λ§¤κ°λ³€μλ΅ Listλ¥Ό λ°›λ” λ©”μ„λ“μ—λ” `List<String>`μ„ λ„κΈΈ μ μμ§€λ§, `List<Object>`λ¥Ό λ°›λ” λ©”μ„λ“μ—λ” λ„κΈΈ μ μ—†λ‹¤.

β†’ μ λ„¤λ¦­μ ν•μ„ νƒ€μ… κ·μΉ™μΈΒ **λ¶κ³µλ³€**Β νΉμ„±μΌλ΅ μΈν•΄,Β `List<String>`Β λ” `List`μ ν•μ„νƒ€μ…μΌλ΅, Β `List<Object>`Β λ” `List`μ ν•μ„ νƒ€μ…μ΄ μ•„λ‹ μ•„μΒ **λ‹¤λ¥Έ νƒ€μ…μΌλ΅ κ°„μ£Ό**ν•κΈ° λ•λ¬Έμ΄λ‹¤.

β†’ λ”°λΌμ„ **`List<Object>`Β κ°™μ€ λ§¤κ°λ³€μν™” νƒ€μ…μ„ μ‚¬μ©ν•  λ•μ™€ λ‹¬λ¦¬Β `List`Β κ°™μ€ νƒ€μ…μ„ μ‚¬μ©ν•λ©΄ νƒ€μ… μ•μ •μ„±μ„ μƒκ²λλ‹¤.**

- λ΅ νƒ€μ…

```java
public class Raw {
    public static void main(String[] args) {
        List<String> strings = new ArrayList<>();
        // String μ»¬λ ‰μ…μ— Integerλ¥Ό λ„£κ³  μλ‹¤.
        unsafeAdd(strings, Integer.valueOf(42));
        String s = strings.get(0);  // μ»΄νμΌλ¬κ°€ μλ™μΌλ΅ ν•λ³€ν™ μ½”λ“λ¥Ό λ„£μ–΄μ¤€λ‹¤.
    }

    private static void unsafeAdd(List list, Object o) { // μ»΄νμΌ μ—λ¬ X
        list.add(o);
    }
}
```

String μ»¬λ ‰μ…μ— Integerλ¥Ό λ„£λ” κ²ƒμ€ κ°€λ¥ν•μ§€λ§ κΊΌλ‚Ό λ• λ°νƒ€μ„ μ—λ¬κ°€ λ°μƒν•λ‹¤.

- `List<Object>`

```java
public class Raw {
    public static void main(String[] args) {
        List<String> strings = new ArrayList<>();
        unsafeAdd(strings, Integer.valueOf(42));
        String s = strings.get(0);
    }

    private static void unsafeAdd(List<Object> list, Object o) {  // μ»΄νμΌ μ—λ¬
        list.add(o);
    }
}
```

## λΉ„ν•μ •μ  μ™€μΌλ“ μΉ΄λ“

μ™€μΌλ“ μΉ΄λ“(`?`)λ€, μ λ„¤λ¦­ νƒ€μ…μ„ μ“°κ³  μ‹¶μ§€λ§Β **μ‹¤μ  νƒ€μ… λ§¤κ°λ³€μκ°€ λ¬΄μ—‡μΈμ§€ μ‹ κ²½μ“°κ³  μ‹¶μ§€ μ•μ„ κ²½μ°**Β μ‚¬μ©ν•  μ μλ” κ²ƒμ„ μλ―Έν•λ‹¤.

ex) μ λ„¤λ¦­ νƒ€μ…μΈΒ `Set<E>`μ λΉ„ν•μ •μ  μ™€μΌλ“μΉ΄λ“ νƒ€μ…μ€Β `Set<?>`μ΄λ‹¤.

λ΅ νƒ€μ…μ—λ” μ•„λ¬΄ μ›μ†λ‚ λ„£μ„ μ μμ–΄ νƒ€μ… λ¶λ³€μ‹μ„ ν›Όμ†ν•κΈ°κ°€ μ‰½λ‹¤. λ°λ©΄ **λΉ„ν•μ •μ  μ™€μΌλ“μΉ΄λ“λ”Β `null`μ„ μ μ™Έν• μ–΄λ–¤ μ›μ†λ„ λ„£μ„ μ μ—†λ‹¤.** μ¦‰, λ‹¤λ¥Έ μ›μ†λ¥Ό λ„£μΌλ ¤ ν•λ©΄ μ»΄νμΌν•  λ• μ—λ¬λ¥Ό λ°μƒν•κ² λλ‹¤.

β†’ μ΄ λ¬Έμ λ¥Ό ν•΄κ²°ν•κΈ° μ„ν•΄ ν•μ •μ  μ™€μΌλ“ μΉ΄λ“νƒ€μ…μ΄ λ‚μ™”λ‹¤.

## λ΅ νƒ€μ…μ„ μ‚¬μ©ν•΄μ•Ό ν•λ” μμ™Έ

### class λ¦¬ν„°λ΄μ—λ” λ΅ νƒ€μ…μ„ μ¨μ•Ό ν•λ‹¤. 
   
μλ°” λ…μ„Έλ” λ°°μ—΄κ³Ό κΈ°λ³Έ νƒ€μ… μ™ΈμΒ `class`Β λ¦¬ν„°λ΄μ— λ§¤κ°λ³€μν™” νƒ€μ…μ„ μ‚¬μ©ν•μ§€ λ»ν•κ² ν•κ³  μλ‹¤. μλ¥Ό λ“¤μ–΄,Β `List.class`λ” ν—μ©ν•μ§€λ§Β `List<String>.class`λ” λ¶κ°€λ¥ν•λ‹¤.


> π’΅ class λ¦¬ν„°λ„ : `String.class`,Β `Integer.class`Β λ“±μ„ λ§ν•λ©° ν•λ‚μ κ°μ²΄λ΅ μƒκ°ν•  μ μλ‹¤.


### instanceof μ—°μ‚°μλ¥Ό μ‚¬μ©ν•΄μ•Ό ν•  κ²½μ°λ” λ΅ νƒ€μ…μ΄λ‚ λΉ„ν•μ •μ  μ™€μΌλ“μΉ΄λ“ νƒ€μ…μ„ μ‚¬μ©ν•λ‹¤. 
   
**λ°νƒ€μ„μ—λ” μ λ„¤λ¦­ νƒ€μ… μ •λ³΄κ°€ μ§€μ›μ§€λ―€λ΅**,Β `instanceof`Β μ—°μ‚°μλ” λΉ„ν•μ •μ  μ™€μΌλ“μΉ΄λ“ νƒ€μ… μ΄μ™Έμ λ§¤κ°λ³€μν™” νƒ€μ…μ—λ” μ μ©ν•  μ μ—†λ‹¤. <br>
λ”°λΌμ„ **λ΅ νƒ€μ…μ΄λ‚ λΉ„ν•μ •μ  μ™€μΌλ“μΉ΄λ“ νƒ€μ…μ΄λ“  κ°™μ€ κ²°κ³Όλ¥Ό λ‚΄κΈ° λ•λ¬Έμ—**, μ°¨λΌλ¦¬ λ” κΉ”λ”ν• λ΅ νƒ€μ…μ„ μ‚¬μ©ν•κΈ°λ„ ν•λ‹¤.

```java
if (o instance of Set){   // λ΅ νƒ€μ…
	Set<?> s = (Set<?>) o;    // μ™€μΌλ“μΉ΄λ“ νƒ€μ…
	...
{
```

`o`μ νƒ€μ…μ΄Β `Set`Β μ„μ„ ν™•μΈν• λ‹¤μ λΉ„ν•μ •μ  μ™€μΌλ“ μΉ΄λ“ νƒ€μ…μΌλ΅ ν•λ³€ν™ ν•κ³  μλ‹¤. κ²€μ‚¬ ν•λ³€ν™μ΄λ―€λ΅, μ»΄νμΌλ¬ κ²½κ³ κ°€ λ¨μ§€ μ•λ”λ‹¤.

## ν•µμ‹¬ μ •λ¦¬

λ΅ νƒ€μ…μ„ μ‚¬μ©ν•λ©΄ λ°νƒ€μ„μ— μμ™Έκ°€ μΌμ–΄λ‚  μ μμΌλ‹ μ‚¬μ©ν•λ©΄ μ• λλ‹¤.Β `Set<Object>`λ” μ–΄λ–¤ νƒ€μ…μ κ°μ²΄λ„ μ €μ¥ν•  μ μλ” λ§¤κ°λ³€μν™” νƒ€μ…μ΄κ³ ,Β `Set<?>`λ” λ¨μΆ…μ νƒ€μ… κ°μ²΄λ§ μ €μ¥ν•  μ μλ” μ™€μΌλ“μΉ΄λ“ νƒ€μ…μ΄λ‹¤. κ·Έλ¦¬κ³  μ΄ λ“¤μ λ΅ νƒ€μ…μΈΒ `Set`λ” λ‹¤λ¥Έ κ²ƒλ“¤κ³Ό λ‹¬λ¦¬ μ•μ „ν•μ§€ μ•λ‹¤.
