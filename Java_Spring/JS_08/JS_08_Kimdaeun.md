## **JVM 힙과 스택 메모리의 역할**
### **1. JVM 힙 메모리**
- 힙 메모리는 **객체와 배열**이 저장되는 공간 -> 동적으로 크기가 조정될 수 있다.
- 모든 객체는 힙에 저장되고, GC(Garbage Collector)가 관리
- **구조**:
  - **Young Generation**:
    - 새롭게 생성된 객체가 저장
    - **Eden 영역**: 객체가 처음 생성되는 영역
    - **Survivor 영역**: Young Generation을 통과한 살아남은 객체가 이동한 영역
  - **Old Generation**:
    - Young Generation에서 오래 살아남은 객체가 존재
    - 메모리에서 더 오래 유지되는 객체를 저장
  - **Metaspace**:
    - 클래스 메타데이터 저장 (Java 8 이후 PermGen 대체)

### **2. JVM 스택 메모리**
- 각 **스레드**마다 생성되고, **메서드 호출과 관련된 데이터**를 저장
- 메서드 호출 시마다 **스택 프레임**이 생성되며, 메서드가 종료되면 스택 프레임이 제거된다.
- 힙보다 접근 속도가 빠르다.
- **저장 데이터**:
  - **메서드 호출 정보** : 매개변수, 지역 변수, 리턴 주소
  - 원시 타입(Primitive Type) : int, char, long, boolean .. 
  - 객체 참조 변수 : 힙의 객체를 가리키는 포인터

---
## **OutOfMemoryError 발생 원인**
**OutOfMemoryError**는 JVM이 메모리를 할당할 수 없는 상황에서 발생한다.
1. **Heap 영역 부족**:
   - 객체가 너무 많아 GC가 힙 메모리를 회수하지 못하는 경우.
     - 대량의 객체를 생성하거나 메모리 누수가 발생한 경우.
2. **Stack 영역 부족**:
   - 재귀 호출이 깊거나 스레드가 너무 많을 때.
     - 무한 재귀 호출로 인해 스택 프레임이 가득 차는 경우.

**해결 방법**:
- JVM 옵션으로 메모리 크기 조정:
  - `-Xmx` (최대 힙 크기), `-Xms` (초기 힙 크기)
  - `-XX:MaxMetaspaceSize` (최대 Metaspace 크기)
- 메모리 누수 방지:
  - 필요 없는 객체를 명시적으로 제거
  - 프로파일링 도구로 누수 확인

---
## **"Stop the World"란?**
**"Stop the World(STW)"**는 JVM에서 **Garbage Collection(GC)**을 수행하기 위해 **모든 애플리케이션 스레드를 일시 중지**하는 상황을 말합니다.

### **발생 원인**
- GC는 힙 메모리를 관리하기 위해 필요 없는 객체를 제거한다.
- GC 작업 동안 프로그램의 일관성을 유지하기 위해 모든 스레드를 중지시킨다.

### **최소화 방법**
1. **GC 튜닝**
   - 적절한 GC 알고리즘 선택:
     - **Serial GC**: 단일 스레드로 수행. 작은 애플리케이션에 적합
     - **Parallel GC**: 다중 스레드로 GC 수행. 대용량 작업에 적합
     - **G1 GC**: STW 시간을 최소화하는 데 초점
   - JVM 옵션 조정:
     - `-XX:MaxGCPauseMillis=<time>`로 최대 GC 일시 중지 시간 설정
2. **메모리 관리 최적화**
   - 객체 생명주기를 짧게 유지
   - 힙 크기 조정으로 GC 호출 빈도 감소.
