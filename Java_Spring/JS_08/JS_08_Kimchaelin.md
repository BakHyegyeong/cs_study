# JVM 힙과 스택 메모리의 역할
## JVM 구조
- 클래스 로더
    - 클래스 파일을 읽어들여 메모리에 로드하는 역할
- 실행 엔진
    - 인터프리터
    - JIT 컴파일러
    - GC
- 런타임 데이터 영역

## JVM 메모리 영역(런타임 데이터 영역)
- PC 레지스터
    - 스레드가 어떤 부분을 실행해야 할지에 대한 기록을 하는 영역
- 스택
    - 메서드 호출 시 생성되는 지역 변수(기본 타입 변수, 참조 타입 변수)와 연산 중간 결과를 저장하는 영역
- 네이티브 메서드 스택
    - 기계어를 실행시키는 영역
- 힙
    - 메서드 호출 시 생성되는 객체와 배열을 저장하는 영역
    - GC의 대상이 되는 영역
    - 구조
        - Young 영역
            - Eden 영역: 새로 생성된 객체가 위치하는 영역
            - Survivor 영역: GC로부터 한번 이상 살아남은 객체가 위치하는 영역
        - Old 영역: 오랫동안 살아남은 객체가 위치하는 영역
        - Metaspace: 클래스 메타 데이터가 위치하는 영역 (Java 8 이후 PermGen을 대체)
- 메서드 영역
    - 클래스 정보와 클래스 변수(static 변수)가 저장되는 영역
    - 런타임 상수 풀: 클래스 파일 상의 상수들을 저장하는 영역

# OutOfMemoryError 발생 원인
- JVM이 관리하는 메모리 영역 중 힙 영역에 객체를 생성할 때, 힙 영역이 부족하여 발생하는 에러
- 힙 영역이 부족한 이유
    - 메모리 누수(Memory Leak): 더 이상 사용하지 않는 객체를 해제하지 않아 발생
    - 메모리 부족: 너무 많은 객체를 생성하여 발생

# "Stop the World"란?
- GC를 실행하는 스레드 외에 모든 애플리케이션 스레드가 작업을 멈추는 것
- 이유
    - GC가 실행되는 동안 새로 생성된 객체가 더 이상 사용되지 않는 객체로 판단되어 메모리에서 해제되는 것을 방지
    - GC가 메모리를 해체 후에 힙의 메모리를 재조정하는 과정이 필요하므로, 이 과정이 완료될 때까지 모든 스레드가 멈춰야 함

## GC의 종류
- Minor GC
    - Young 영역에서 발생하는 GC
    - Eden 영역에서 사용되지 않는 객체를 제거 후 Survivor 영역으로 이동
    - Survivor 영역이 가득 차면, 살아남은 객체를 다른 Survivor 영역으로 이동
- Major GC (Full GC)
    - Old 영역에서 발생하는 GC
    - Old 영역에서 사용되지 않는 객체를 제거
    - 전체 힙 영역을 검사하여 사용되지 않는 객체를 제거
