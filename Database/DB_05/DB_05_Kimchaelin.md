# 인덱스의 개념과 설정 기준(+다중 컬럼 인덱스)
## 인덱스
- 데이터베이스 테이블에 대한 검색 속도를 높이기 위해 사용하는 자료구조

<img src="https://velog.velcdn.com/images/kwontae1313/post/ca5a12d5-e42e-4b04-808f-dd05c89d97eb/image.png" width="50%">

- 특정 데이터를 찾기위해 모든 데이터를 검색하는 것이 아닌 특정 데이터 위치를 알려주는 데이터가 있어, 검색 속도가 빨라진다.
- 인덱스는 테이블의 컬럼에 대한 정보를 가지고 있으며, 해당 컬럼을 기준으로 데이터를 정렬한다.

### 인덱스의 장/단점
#### 장점
- 검색 속도가 빠르다.

#### 단점
- 인덱스를 생성하면 디스크 공간이 추가로 사용된다.
- 인덱스 관리를 위한 추가적인 작업이 필요하다.
- 잘못 사용하면 오히려 성능이 저하될 수 있다.

### 인덱스를 사용하면 좋은 경우
- 규모가 큰 테이블
- 삽입, 수정, 삭제 작업이 자주 발생하지 않는 컬럼
- WHERE나 ORDER BY, JOIN 등이 자주 사용되는 컬럼
- 데이터의 중복도가 낮은 컬럼

### 인덱스 설정 기준
| 기준      | 설명                                                                   |
|---------|----------------------------------------------------------------------|
| 카디널리티   | 컬럼에 사용되는 값의 다양성, 중복 수치가 낮을수록 카디널리티가 높다.(즉, 카디널리티가 높을수록 인덱스를 사용하면 좋다) |
| 데이터 중복도 | 중복도가 낮을수록 인덱스의 효율이 높아진다.                                             |
| 활용도     | WHERE, ORDER BY, JOIN 등이 실제 작업에서 자주 사용되는 컬럼일수록 인덱스를 사용하면 좋다.         |
| 선택도     | 특정 값을 찾을 떄 해당 컬럼을 찾는 비율, 선택도가 낮을 수록 인덱스를 사용하면 좋다.(5~10% 정도가 적당함)     |

## 다중 컬럼 인덱스
- 두 개 이상의 컬럼을 조합하여 인덱스를 생성하는 것
- where 절이나 order by 절에 여러 컬럼을 사용할 때 유용하다.

```sql
CREATE INDEX idx_example ON table_name(col1, col2);
```

> ### 선택도 계산
> 
> ex) 10개 rows를 가지는 ‘학생’ 테이블에 ‘학번’, ‘이름’, ‘성별’ 컬럼이 존재. (학번은 고유하고, 성별은 남녀 1:1 비율)
> 
>- ‘학번’의 선택도 = 1/10*100 = 10%
 >  - SELECT COUNT(1) FROM '학생' WHERE '학번' = 1; (모두 고유하므로 특정 값: 1)
>
>- ‘성별’의 선택도 = 5/10*100 = 50%
>  - SELECT COUNT(1) FROM '학생' WHERE '성별' = F; (5명씩 같으므로 특정 값: 5)
> #### 즉, 선택도는 특정 필드값을 지정했을 때 선택되는 레코드 수를 테이블 전체 레코드 수로 나눈 것

# 실행 계획(EXPLAIN)과 쿼리 힌트의 역할과 사용 방법
## 실행 계획(EXPLAIN)
- 쿼리의 실행 계획을 확인하는 명령어
- 쿼리의 실행 계획을 확인하면, 쿼리가 어떻게 실행되는지, 어떤 인덱스를 사용하는지, 어떤 테이블을 참조하는지 등을 확인할 수 있다.
- 이를 통해 쿼리의 성능을 분석하고, 최적화할 수 있다.
#### 실행 계획에서 제공하는 정보
- 스캔 방법 : 테이블을 어떻게 읽는지
- 조인 방법 : 어떤 순서로 조인을 수행하는지
- 필터 조건 : where 절에 사용된 조건
- 추정 비용 : 쿼리의 비용을 추정한 값
- 추정 행 수 : 쿼리의 결과로 반환될 행 수
#### 실행 계획 확인 방법
- EXPLAIN PLAN
- SET AUTOTRACE
- SQL TRACE

> 옵티마이저
> DBMS에서 최적의 실행 계획을 선택하는 역할을 하는 핵심적인 컴포넌트

## 쿼리 힌트
- 쿼리 실행 시 DBMS가 쿼리 실행 계획을 수립할 때, 사용자가 직접 최적의 실행 계획을 지정하는 방법
#### 사용 목적
- 기본 실행 계획이 비효율적인 경우 직접 수정
- 특정 인덱스를 사용하도록 지정
- 조인 순서를 변경
#### 사용 방법
ex) SELEXT /*+ 힌트 내용*/
```sql
SELECT /*+ INDEX(테이블명 인덱스명) */ * FROM 테이블명;
```
