# 격리 수준(Isolation Level)의 종류와 각 수준의 특징

## 격리 수준(Isolation Level)
- 여러 트랜잭션이 동시에 실행될 때 서로 영향을 미치지 않고 독립적으로 실행되어야하는 정도
- 격리 수준이 높을수록 데이터의 정확성은 높아지지만 성능은 떨어질 수 있다. (SERIALIZABLE - 가장 높은 수준)

### 3가지 이상 현상
- **Dirty Read(더티 리드)**
  - 어떤 트랜잭션이 커밋되기 전에 다른 트랜잭션이 수정 중인 데이터를 읽는 현상
  - 트랜잭션이 롤백되면 수정 중이던 데이터를 읽은 트랜잭션의 데이터는 더티 데이터가 된다.

- **Non-Repeatable Read(비반복 가능한 리드)**
    - 동일한 데이터를 두 번 이상 읽었을 때 값이 달라지는 현상

- **Phantom Read(팬텀 리드)**
  - 동일한 쿼리를 두 번 이상 수행했을 때, 첫 번째 쿼리에서 없던 데이터가 두 번째 쿼리에서 나타나거나 사라지는 현상

|격리 수준|Dirty Read|Non-Repeatable Read|Phantom Read|
|---|---|---|---|
|READ UNCOMMITTED|O|O|O|
|READ COMMITTED|X|O|O|
|REPEATABLE READ|X|X|O|
|SERIALIZABLE|X|X|X|

### 격리 수준의 종류
1. **READ UNCOMMITTED(미완료 읽기)**
    - 트랜잭션이 커밋되지 않은 데이터를 읽을 수 있다.
    - 다른 트랜잭션이 수정 중인 데이터를 읽을 수 있다.
    - 데이터의 일관성을 보장하지 않는 가장 낮은 수준의 격리 수준
2. **READ COMMITTED(완료 읽기)** - ex) PostgreSQL, Oracle
    - 커밋된 데이터만 읽을 수 있다.
    - 다른 트랜잭션이 수정 중인 데이터를 읽을 수 없다.
3. **REPEATABLE READ(반복 가능한 읽기)** - ex) InnoDB
    - 자신의 트랜잭션이 생성되기 전의 트랜잭션에서 commit된 데이터만 읽을 수 있다.
    - 다른 트랜잭션이 수정 중인 데이터를 읽을 수 없다.
4. **SERIALIZABLE(직렬화 가능)**
    - 여러 트랜잭션이 동일한 레코드에 동시에 접근할 수 없다.
      - 동일한 레코드에 동시에 접근할 수 없어, 서로의 작업이 완료될 때까지 기다리는 교착상태가 발생할 수 있다.
    - 트랜잭션을 순차적으로 진행시키는 가장 높은 수준의 격리 수준(성능이 가장 떨어짐)

# 비관적 락과 낙관적 락의 차이점
## 락(Lock)
  - 데이터베이스에서 동시성 제어를 위해 사용되는 기술
  - 여러 트랜잭션이 동시에 데이터에 접근할 때 데이터의 일관성을 유지하기 위해 사용

## 비관적 락(Pessimistic Lock)
- 동시성 이슈로 충돌이 난다는 것을 가정하여, 미리 락을 걸어 다른 트랜잭션이 해당 데이터에 접근하지 못하도록 하는 방식
- Reatable Read, Syncronized 정도의 격리 수준 제공
- 데이터의 일관성을 보장할 수 있음
- 종류
  - **읽기 락(공유 락)**
    - 한 트랜잭션이 작업 중 다른 트랜잭션은 해당 데이터를 읽을 수 있지만, 쓰기 작업은 불가능
  - **쓰기 락(배타적 락)**
    - 한 트랜잭션이 작업 중 다른 트랜잭션은 해당 데이터를 읽거나 쓰기 작업을 할 수 없음

## 낙관적 락(Optimistic Lock)
- 동시성 이슈가 나지 않을 상황을 가정하여, 충돌 발생 시 개발자가 수동으로 롤백처리를 하는 방식
- row마다 version과 같은 별도 컬럼을 두어, 데이터를 읽을 때 버전을 함께 읽어오며, 데이터를 수정할 때 버전을 비교하여 충돌이 나면 나중에 온 요청 롤백처리.
- 해당 락은 트핸잭션도 필요하지 않고 DB에 락을 거는 작업이 없어, **비관적 락보다 성능이 좋음**
- 최대의 단점이 수동으로 해줘야하는 롤백처리

## 비관적 락과 낙관적 락의 사용하면 좋은 경우
- **비관적 락**
  - 데이터의 변경이 잦은 경우(충돌이 많이 날 것으로 예상되는 경우)
  - 데이터의 일관성을 보장해야 하는 경우
- **낙관적 락**
  - 데이터의 변경이 적은 경우(충돌이 적게 날 것으로 예상되는 경우)
  - 조회 작업이 많아, 동시 접근 성능이 중요한 경우
