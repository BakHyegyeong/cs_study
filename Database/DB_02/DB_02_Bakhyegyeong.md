# 키

: 테이블 간의 관계를 조금 더 명확하게 하고 테이블 자체의 인덱스를 위해 설정된 장치

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2F4wDZ6%2Fbtrq12sxO2y%2FLOE2i9NTCx6LRtyH5KvsP1%2Fimg.png)

## 유일성과 최소성

- 유일성 : 하나의 키값으로 튜플을 유일하게 식별할 수 있는 성질
- 최소성 : 키를 구성하는 속성들 중 꼭 필요한 최소한의 속성들로만 키를 구성하는 성질

## 키의 종류

### 기본키 (PK, 프라이머리키)

: 유일성과 최소성을 만족하며 **중복되지 않고 null값이 아닌** 고유한 식별자이다.

→ 두 기본키를 합친 복합키도 가능하다.

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FvuClu%2Fbtrq23krXAk%2FvBjMYCaFhUIK9KgiJJDDQK%2Fimg.png)

- 자연키 : 기존의 속성에서 기본키로 선택될 수 있는 속성
→ 변할 수 있다.
- 인조키 : 인위적으로 생성한 키로써 유저 아이디같은 기존에 없던 속성
→ 변하지 않는다.

### 외래키

: 개체와의 관계를 식별하는 데 사용한다.

→ 기본키와 달리 null값을 허용하며 **하나의 테이블 안에서 값이 중복되어질 수 있다.**

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FbxIlPY%2Fbtrq7bgUfck%2FqJo7lDej9yMSgCggnkO2nK%2Fimg.png)

### 후보키

: 기본키가 될 수 있는 후보들이며 유일성과 최소성을 만족한다.

### 대체키

: 후보키가 두 개 이상일 경우 기본키로 선택되지 못한 후보키

→ 후보키 = 기본키 + 대체키

### 슈퍼키

: 유일성을 갖춘 키

## 무결성 제약 조건

**데이터베이스의 정확성과 일관성을 보장하기 위해 설정되는 조건**으로, 데이터의 저장, 삭제, 수정 등을 제한하거나 조절하는 역할

### 무결성

데이터베이스에서 **데이터의 정확성, 일관성**을 유지하는 것

→ 데이터에 결함이 없는 상태

- 도메인 무결성 : 각 속성이 정의된 **도메인에 속한 값만을** 가질 수 있어야 한다.
- 개체 무결성 : 기본키가 각 튜플(레코드)를 고유하게 식별하고, null값을 허용하지 않아야 한다.
- 참조 무결성 : 외래키가 참조하는 테이블의 기본키와 일치하거나 null값임을 보장해 **데이터 간의 일관성을 유지**해야 한다.


---

# MySQL

데이터를 저장하고 관리하는데 사용되는 **오픈 소스 관계형 데이터 베이스 관리 시스템**이다.

## MySQL 서버 구조

MySQL 서버는 **MySQL 엔진**과 **스토리지 엔진의** 두 가지 구조로 나뉜다.

- **MySQL 엔진** :  SQL 처리 및 최적화, 보조 메모리 통신과 같은 **데이터베이스의 일반적인 기능**을 담당한다.
- **스토리지 엔진** : **디스크에 실제 데이터를 저장하거나 읽는** 역할을 담당한다.

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FCiecA%2FbtqTLx5TgII%2FXgDD7NmPgPvAklS2xQUoB0%2Fimg.png)

![](https://img1.daumcdn.net/thumb/R1280x0/?scode=mtistory2&fname=https%3A%2F%2Fblog.kakaocdn.net%2Fdn%2FGNy91%2FbtrEzohm9oZ%2FSlGmwjgx3JXEEKyaeOion1%2Fimg.png)

### MySQL 엔진

1. 커넥션 헨들러 : 클라이언트로부터의 접속 및 쿼리 요청을 처리
2. SQL 인터페이스 : DML, DDL, Procedure, View 등 SQL 인터페이스 제공
3. SQL 파서 : **SQL문법 오류 탐지** 및 SQL 쿼리 문장을 MySQL이 처리하기 좋은 **토큰 단위로 나눠서 트리 형태로 파싱** 하는 작업 담당
    
    ![](https://velog.velcdn.com/images/juhyeon1114/post/e06e9948-906b-42db-b7b8-5d3908b295e0/image.png)
    
4. 전처리기 : 토큰에 사용된 테이블 이름, 칼럼 이름, 내장 함수 등이 **실제로 존재하는지, 접근 권한이 있는지 검증**
5. SQL 옵티마이저 : 검증된 쿼리의 최적화된 실행 담당
    - 규칙 기반 최적화 : 데이터의 상태는 고려하지 않고, **Optimizer에 내장된 우선순위대로 최적화**하는 것
    - 비용 기반 최적화 : 쿼리를 처리하기 위한 방법 중에서 테이블의 통계 정보를 이용해서 **DB에 부하가 덜 가는 방향으로 쿼리를 최적화**하는 것
6. 캐시와 버퍼 : 성능 향상을 위한 보조 저장소 기능 담당

### 스토리지 엔진

- MySQL 엔진과 플러그인 형태로 **연동/분리 가능**하다.
- MySQL엔진은 핸들러 API(핸들러 요청)를 통해 스토리지 엔진에 읽기/쓰기 요청이 가능하다.
- MySQL 서버에서의 MySQL엔진은 1개, 스토리지 엔진은 여러개를 동시에 사용 가능하다.

이 스토리지 엔진에서 자주 쓰이는 것이 **InnoDB와 MyISAM**이다.

## InnoDB

### **장점**

- 트랜젝션을 지원하며 다양한 기능을 통해 데이터 무결성을 보장한다.
    
    → commit, rollback, 장애복구, **row-level locking(행 단위의 잠금)**, 외래키 등의 기능을 제공한다.
    
- 다수의 사용자 동시 접속과 대용량 데이터 처리에 유리하다.
- CPU 효율 우수
- 자체적으로 메인 메모리 안에 데이터 캐싱, 인덱싱을 위한 버퍼 풀을 관리

### **단점**

- 풀텍스트 인덱스를 지원하지 않는다.
- 다양한 기능을 지원하기 때문에 고사양의 서버를 요구한다.


> ⭐ **풀텍스트 인덱스** <br>
검색 엔진과 유사하게 자연 언어를 이용해 검색할 수 있는 특별한 인덱스로 모든 데이터 문자열의 단어를 인덱스로 저장한다.


## **MyISAM**

### **장점**

- InnoDB에 비해 요구하는 서버의 사양이 낮다.
- 풀텍스트 인덱스를 지원해 검색 능력이 우수하다.
- 항상 테이블에 Row Count를 가지고 있어 `SELECT count(*)` 명령의 속도가 빠르다.
- SELECT 검색 속도가 빠르다.

### **단점**

- **row level locking 미지원**
    
    → CRUD 시 해당 Table 전체에 Locking이 걸린다.
    
    → row가 많아지면 속도가 저하된다.
    
    → 다중 사용자 환경에서 한 사용자가 어떠한 테이블의 데이터를 읽을 경우, 다른 사용자 또한 해당 테이블에 대해 읽기 작업만 수행 가능하다. 
    
    → 기존 사용자가 해당 데이터를 수정할 경우, 다른 사용자는 그 테이블에 접근조차 하지 못하고 대기해야만 한다.
    
- 데이터 무결성을 보장하지 않는다.
- 트랜잭션을 지원하지 않는다.

## InnoDB와 MyISAM 차이점

- MyISAM : **단순 조회 작업**이 많고 트랜젝션 처리가 필요 없을 경우
- InnoDB : 트랜잭션 처리가 필요한 **복잡한 대용량 데이터**를 처리할 경우

| InnoDB | MyISAM |
| --- | --- |
| MySQL 5.5 이후 기본 스토리지 엔진 | MySQL 5.5 이전 기본 스토리지 엔진 |
| 데이터 무결성(트랜잭션 포함) 지원 | 데이터 무결성 지원 X |
| 행 단위 잠금 | 테이블 단위 잠금 |
| 외래키 지원 | 제약조건 지원 X |
| Full-text 인덱싱 불가능 | Full-text 인덱싱 가능 |
| 가벼우며 요구하는 서버의 사양이 낮다. | 많은 기능을 지원하기에 상대적으로 고사양의 서버를 요구한다. |